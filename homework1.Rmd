---
title: "Hw1"
author: "HyeongHwan Kim"
date: "2023-09-20"
output: html_document
---

# Setting

```{r, eval = FALSE}
install.packages('palmerpenguins')
```

```{r}
library(ggplot2)
library(palmerpenguins)
```

# Textbook 2.2.5
## Problem 4

```{r}
ggplot(data = penguins, mapping = aes(x = species, y = bill_depth_mm)) +
  geom_point()
```

Boxplot would be better.

```{r}
ggplot(data = penguins, mapping = aes(x = species, y = bill_depth_mm)) +
  geom_boxplot()
```

## Problem 5

```{r, eval = FALSE}
ggplot(data = penguins) + 
  geom_point()
```

mapping parameter should NOT be blank.

```{r}
ggplot(data = penguins) + 
  geom_point(mapping = aes(x = bill_length_mm, y = bill_depth_mm))
```

# Textbook 2.4.3
## Problem 3

```{r}
ggplot(penguins, mapping = aes(x = bill_length_mm)) +
  geom_histogram(bins = 1)
```
```{r}
ggplot(penguins, mapping = aes(x = bill_length_mm)) +
  geom_histogram(bins = 10)
```

The parameter 'bin' means the number of bars showed on the histogram.
For example, there is only one bar on the graph when the value of bin is 1.

# Textbook 2.5.5
## Problem 2

```{r}
head(mpg, 3)
?mpg
```


```{r}
ggplot(data = mpg, mapping = aes(x = hwy, y = displ)) +
  geom_point(aes(color = cty))
```

```{r}
ggplot(data = mpg, mapping = aes(x = hwy, y = displ)) +
  geom_point(aes(size = cty))
```

```{r}
ggplot(data = mpg, mapping = aes(x = hwy, y = displ)) +
  geom_point(aes(color = cty, size = cty))
```

```{r, eval = FALSE}
ggplot(data = mpg, mapping = aes(x = hwy, y = displ)) +
  geom_point(aes(shape = cty))
```

A numerical variable is recognized continuous, so it cannot be used for the value of shape parameter. It's because a domain of continuous variable is uncountable, but the number of shape parameter is not.

```{r}
ggplot(data = mpg, mapping = aes(x = hwy, y = displ)) +
  geom_point(aes(size = class))
```

For other parameters (e.g. size, color), if using numerical variables, the plot shows 'categorized variable' by dividing the range of the data. However, if using categorical variables, just shows the variables as the they are.

## Problem 6

```{r}
ggplot(
  data = penguins,
  mapping = aes(
    x = bill_length_mm, y = bill_depth_mm, 
    color = species, shape = species
  )
) +
  geom_point() +
  labs(color = "Species")
```

This is because the title of color legend and shape legend is different. ('species' and 'Species') So, they should be same.

```{r}
ggplot(
  data = penguins,
  mapping = aes(
    x = bill_length_mm, y = bill_depth_mm, 
    color = species, shape = species
  )
) +
  geom_point() +
  labs(color = "Species", shape = "Species")
```

Or just delete labs() function.

```{r}
ggplot(
  data = penguins,
  mapping = aes(
    x = bill_length_mm, y = bill_depth_mm, 
    color = species, shape = species
  )
) +
  geom_point()
```
# Textbook 12.2.1
## Problem 2

```{r}
head(mpg, 3)
```

```{r}
ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) +
  geom_point(aes(color = drv, shape = drv)) +
  xlab("City MPG") +
  ylab("HIghway MPG") +
  labs(color = "Type of\ndrive train", shape = "Type of\ndrive train")
```

# Textbook 4.2.5
## Problem 3

```{r}
library(nycflights13)
library(tidyverse)
?flights
```

```{r}
head(flights, 3)
```

```{r}
flights_sorted <- arrange(flights, desc(distance / air_time))
head(flights_sorted, 3)
```

## Problem 4
```{r}
flights_2013 <- flights %>% 
  filter(year == 2013) %>%
  select(month, day) %>%
  unique()
nrow(flights_2013)
```

Because the number of row is 365, a flight was on every day of 2013.

## Problem 5

```{r}
flights %>% 
  arrange(desc(distance)) 
```

```{r}
flights %>% 
  filter(distance == 4983) %>% # max distance 
  select(flight) %>%
  unique()
```

The flight 51 traveled the farthest distance.

```{r}
flights %>% 
  arrange(distance)
```

```{r}
flights %>% 
  filter(distance == 80) %>%
  select(flight) %>%
  unique()
```

And the flights 3833, 4193, 4502, 4645, 4619, 3271, 4616, 4457 traveled the least distance.

# Textbook 4.5.7
## Problem 1

```{r}
flights %>% 
  group_by(carrier) %>%
  summarise(mean(dep_delay, na.rm = TRUE)) %>%
  rename("avg_dep_delay" = "mean(dep_delay, na.rm = TRUE)") %>%
  arrange(desc(avg_dep_delay))
```

The carrier 'F9' has the worst average departure delay.

```{r}
flights %>% 
  group_by(carrier) %>%
  summarise(mean(arr_delay, na.rm = TRUE)) %>%
  rename("avg_arr_delay" = "mean(arr_delay, na.rm = TRUE)") %>%
  arrange(desc(avg_arr_delay))
```

The same carrier also has the worst average arrival delay.
Therefore, F9 has the worst time delay.

## Problem 2

```{r}
flights %>% 
  group_by(dest) %>%
  filter(rank(desc(dep_delay)) == 1) %>%
  select(dest, flight)
```

## Problem 3

```{r}

#flights %>% 
#  mutate(date = paste(year, month, day)) %>%
#  group_by(date) %>%
#  summarise(mean(arr_delay, na.rm = TRUE)) %>%
#  arrange(date)

flights_hour <- flights %>%
  mutate(dep_hour = as.character(sort(as.integer(sched_dep_time / 100))))

flights_hour %>%
  filter(dep_hour == '1') %>%
  nrow() #only one

flights_hour <- flights_hour %>%
  filter(dep_hour != '1')

unique_hour <- flights_hour %>%
  select(dep_hour) %>%
  unique() %>%
  dplyr::pull(1)


ggplot(data = flights_hour, mapping = aes(x = dep_hour, y = dep_delay)) +
  geom_boxplot(na.rm = TRUE, outlier.shape = NA) +
  coord_cartesian(ylim = c(-50, 50)) +
  scale_x_discrete(limits = unique_hour)
```

There are too many outliers, so removed them. 
The flights delay more on 10 a.m. and 17 p.m.
The distribution of dep_delay~dep_hour looks like W shape.
